<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <title>Jocul Cuvintelor - Prezentator</title>
    <link rel="stylesheet" href="/static/tv.css">
    <style>
        .controls { margin-top: 18px; text-align:center }
    </style>
</head>
<body>
    <div class="tv-wrap">
        <div class="tv-header">
            <img src="/pictures/logo.png" alt="Jocul Cuvintelor" />
        </div>
        <div class="tv-panel">
            <div class="tv-row" style="font-size:20px; margin-bottom:10px">
                <span id="jucator_info" class="chip">Așteptare start joc...</span>
                <span id="answer-timer-host" class="chip" style="min-width:180px; text-align:center"></span>
            </div>
            <div id="definitie" class="tv-def">...</div>
            <div id="cuvant" class="tv-big">...</div>
            <div class="controls">
                <button id="btn-continua" class="btn btn-gold" disabled>Continuă</button>
                <button id="btn-letter" class="btn" style="background:linear-gradient(180deg,#63b3ff,#2e7cd9); color:#fff" disabled>Oferă Literă</button>
                <div id="validation-controls" style="display:none; margin-top:10px">
                    <button id="btn-corect" class="btn" style="background:linear-gradient(180deg,#5fe3b3,#18b97d)">CORECT</button>
                    <button id="btn-gresit" class="btn btn-red">GREȘIT</button>
                </div>
            </div>
        </div>
    </div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
    <script>
        const socket = io();

        // Auto-reload on server notification (dev convenience)
        socket.on('reload', () => {
            window.location.reload();
        });

        const btnContinua = document.getElementById('btn-continua');
    const validationControls = document.getElementById('validation-controls');
        const btnCorect = document.getElementById('btn-corect');
        const btnGresit = document.getElementById('btn-gresit');
        const answerTimerHost = document.getElementById('answer-timer-host');
    const btnLetter = document.getElementById('btn-letter');

        btnContinua.addEventListener('click', () => socket.emit('next_step'));
    btnLetter.addEventListener('click', () => socket.emit('request_letter'));
        btnCorect.addEventListener('click', () => socket.emit('host_validation', {status: 'corect'}));
        btnGresit.addEventListener('click', () => socket.emit('host_validation', {status: 'gresit'}));

        socket.on('update_prezentator', (data) => {
            document.getElementById('jucator_info').textContent = `Jucător: ${data.jucator_curent} | Scor: ${data.scor} lei`;
            document.getElementById('definitie').textContent = `Definiție: ${data.definitie}`;
            document.getElementById('cuvant').textContent = (data.cuvant || '').split('').join(' ');
            
            // Logica de afisare/blocare butoane
            const butoane = data.stare_butoane.prezentator;
            btnContinua.disabled = !butoane.continua;
            btnLetter.disabled = !butoane.cer_litera;

            if(butoane.validare) {
                validationControls.style.display = 'block';
                btnContinua.style.display = 'none';
            } else {
                validationControls.style.display = 'none';
                btnContinua.style.display = 'block';
            }
        });

        socket.on('update_timer', (data) => {
            if (data.type === 'answer') {
                answerTimerHost.textContent = `Timp Răspuns: ${data.time}`;
            } else {
                 answerTimerHost.textContent = '';
            }
        });
        
    socket.on('game_over', () => {
             document.querySelector('.card').innerHTML = '<h1>Joc Terminat!</h1>';
        });
    </script>
</body>
</html>